
<FuncListing@FlatSplitter>:
    size_hint_x: None
    width: '200dp'
    sizable_from: 'left'
    strip_size: '5dp'
    min_size: '15dp'
    max_size: dp(400) + max(funcs.minimum_width, control_box.minimum_width)
    spacing: '5dp'
    flat_color: app.theme.accent
    BoxLayout:
        orientation: 'vertical'
        ScrollView:
            bar_width: '10dp'
            scroll_type: ['bars']
            size_hint_y: None
            height: '68'
            BoxLayout:
                size_hint_min_x: control_box.minimum_width
                orientation: 'vertical'
                FlatLabel:
                    text: 'Functions'
                    flat_color: app.theme.text_primary
                BoxLayout:
                    id: control_box
                    orientation: 'horizontal'
                    padding: '5dp'
                    spacing: '5dp'
                    FlatSpinner:
                        id: func_spin
                        values: sorted(app.function_factory.funcs_inst.keys()) if app.function_factory.funcs_inst else []
                        text_autoupdate: True
                        size_hint_min_x: self.minimum_width
                        flat_color: app.theme.text_primary
                        flat_menu_color: app.theme.accent
                        flat_drop_background_color: app.theme.primary_text
                        flat_drop_text_color: app.theme.text_primary
                        flat_border_color: app.theme.divider
                    DraggingWidget:
                        drag_controller: knspace.dragger
                        drag_widget: func_spin.__self__
                        obj_dragged: func_spin.__self__
                        drag_cls: 'func_spinner'
                    FlatImageButton:
                        scale_down_color: True
                        source: 'flat_plus.png'
                        flat_color: app.theme.accent
                        on_release: funcs.add_func(func_spin.text)
        ScrollView:
            bar_width: '10dp'
            scroll_type: ['bars']
            FuncList:
                id: funcs
                drag_append_end: True
                spacer_props: {'size_hint_y': None, 'height': '50dp', 'size_hint_min_x': '40dp'}
                drag_classes: ['func', 'func_spinner']
                function_factory: app.function_factory
                knsname: 'funcs'
                orientation: 'vertical'
                spacing: '3dp'
                padding: '0dp', '10dp'
                size_hint_y: None
                height: self.minimum_height
                size_hint_min_x: self.minimum_width
                touch_deselect_last: True


<FuncPropTextWidget>:
    size_hint_y: None
    height: self.minimum_height
    multiline: False
    on_focus: if not self.focus: self._update_attr(self.text)
