
<PinnedGraph@KNSpaceBehavior+BoxLayout>

<MainView@BoxLayout>:
    orientation: 'vertical'
    canvas:
        Color:
            rgba: app.theme.primary
        Rectangle:
            pos: self.pos
            size: self.size
    StackLayout:  # --------------------- TOP --------------------
        size_hint_y: None
        height: self.minimum_height
        orientation: 'lr-tb'
        VideoControl
            id: video
        FlatDivider:
            size_hint_y: None
            height: video.height
            color: app.theme.divider
        FlatImageToggleButton:
            knsname: 'gui_remote_view'
            size_hint_y: None
            height: video.height
            on_release:
                app.remote_viewer.start_listener() if self.state == 'down' else app.remote_viewer.stop_listener()
                if app.view_controller.propixx_lib and self.state == 'down': app.view_controller.set_led_mode(app.view_controller.LED_mode_idle)
            state: 'down' if app.remote_viewer.running else 'normal'
            source: 'ic_cast_white_24dp_1x.png' if self.state == 'normal' else 'ic_cast_connected_white_24dp_1x.png'
            scale_down_color: True
            flat_color: app.theme.accent
            hover_text: 'Remote viewer ' + ('[b]disconnected[/b]' if self.state == 'normal' else '[b]connected[/b]')
        FlatDivider:
            size_hint_y: None
            height: video.height
            color: app.theme.divider
        PaintBar
        FlatDivider:
            size_hint_y: None
            height: video.height
            color: app.theme.divider
        ControlBar
        FlatDivider:
            size_hint_y: None
            height: video.height
            color: app.theme.divider
        DataBar
        FlatDivider:
            size_hint_y: None
            height: video.height
            color: app.theme.divider
        FlatErrorIndicatorPopup:
            scale_down_color: True
            source: 'flat_alert.png'
            flat_color: app.theme.accent
            size_hint_y: None
            height: video.height
            on_parent: app.error_indicator = self
    PinnedGraph:
        knsname: 'pinned_graph'
        size_hint_y: None
        height: self.minimum_height
        canvas:
            Color:
                rgba: app.theme.primary_text
            Rectangle:
                pos: self.pos
                size: self.size
    BoxLayout:
        orientation: 'horizontal'
        canvas:
            Color:
                rgba: app.theme.primary_text
            Rectangle:
                pos: self.pos
                size: self.size
        ControlDisplay
        BoxLayout:
            size_hint_x: None
            width: self.minimum_width
            orientation: 'horizontal'
            spacing: '5dp'
            ShapeListing
            StageListing
            FuncListing
